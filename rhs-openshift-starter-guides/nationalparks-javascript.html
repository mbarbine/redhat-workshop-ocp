<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: OpenShift Starter Guides</title>
    <link rel="canonical" href="http://redhat-scholars.github.io/openshift-starter-guides/rhs-openshift-starter-guides/nationalparks-javascript.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img
          src="../_/img/header_logo.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="http://redhat-scholars.github.io/openshift-starter-guides">OpenShift Starter Guides</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
        <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-scholars.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-scholars.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-scholars.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rhs-openshift-starter-guides" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">OpenShift Starter Guides</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="common-workshop-summary.html">Workshop Summary</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="common-environment.html">OCP architecture</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-explore.html">Explore OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-explore.html#the_web_console">The Web Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-explore.html#command_line_interface">Command Line Interface</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-explore.html#download_openshift_cli">Download OpenShift CLI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="common-explore.html#download_and_install_openshift_cli_on_linux">Download and Install OpenShift CLI on Linux</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="common-explore.html#download_and_install_openshift_cli_on_mac">Download and Install OpenShift CLI on Mac OS X</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="common-explore.html#download_and_install_openshift_cli_on_windows">Download and Install OpenShift CLI on Windows</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-explore.html#connect_to_the_cluster_with_cli">Connect to the OpenShift Cluster from CLI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="common-explore.html#working_with_proxies">Working with proxies</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="prerequisites.html">Prerequisites</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="prerequisites.html#openshift_pipelines">OpenShift Pipelines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="prerequisites.html#install_openshift_pipelines_from_operatorhub">Install OpenShift Pipelines from OperatorHub</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="prerequisites.html#github_account">GitHub Account</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="projects.html">Projects</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="projects.html#create_your_first_project">Create your First Project</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="common-parksmap-architecture.html">Parksmap Architecture</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="parksmap-container-image.html">Parksmap App</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-container-image.html#deploy_your_first_image">Exercise: Deploying your First Image</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-container-image.html#containers_and_pods">Background: Containers and Pods</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-container-image.html#examining_the_pod">Exercise: Examining the Pod</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-container-image.html#customizing_image_lifecycle_behavior">Background: Customizing the Image Lifecycle Behavior</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-container-image.html#services">Background: Services</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="parksmap-scaling.html">Scaling Apps</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-scaling.html#deployment_configs_and_replication_controllers">Background: Deployment Configurations and Replication Controllers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-scaling.html#exploring_deployment_related_objects">Exercise: Exploring Deployment-related Objects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-scaling.html#scaling_the_application">Exercise: Scaling the Application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-scaling.html#application_self_healing">Application "Self Healing"</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-scaling.html#scale_down">Scale down</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="parksmap-routes.html">Routes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-routes.html#routes">Background: Routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-routes.html#creating_a_route">Exercise: Creating a Route</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="parksmap-logging.html">Logging</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-logging.html#container_logs">Background: Container Logs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-logging.html#examining_logs">Examining Logs</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="parksmap-permissions.html">Permissions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-permissions.html#grant_serviceaccount_view_permissions">Grant Service Account View Permissions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-permissions.html#redeploy_application">Exercise: Redeploy Application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-permissions.html#grant_user_view_permissions">Exercise: Grant User View Permissions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="parksmap-rsh.html">Connecting to a Container</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-rsh.html#remote_shell_session_to_container_using_cli">Exercise: Remote Shell Session to a Container Using the CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-rsh.html#execute_command_in_container">Exercise: Remote Shell Session to a Container Using the Web Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-rsh.html#remote_shell_session_to_container_using_webconsole">Exercise: Execute a Command in a Container</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-java.html">Nationalparks Java App</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java.html#source_to_image">Background: Source-to-Image (S2I)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-java.html#creating_java_application">Exercise: Creating a Java application</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="nationalparks-java.html#add_to_project">Add to Project</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="nationalparks-java.html#using_application_code_on_git_server">Using Application Code on a Git Server</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="nationalparks-java.html#build_code_on_openshift">Build the Code on OpenShift</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-java-databases.html">Connecting to a Database</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-databases.html#storage">Background: Storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-databases.html#deploy_mongodb">Exercise: Deploy MongoDB</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-databases.html#exploring_openshift_magic">Exercise: Exploring OpenShift Magic</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-databases.html#data_data_everywhere">Exercise: Data, Data, Everywhere</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-databases.html#working_with_labels">Exercise: Working With Labels</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-application-health.html">Application Healthchecks</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-application-health.html#add_health_checks">Exercise: Add Health Checks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-java-pipeline.html">Continuous Integration and Pipelines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline.html#understanding_tekton">Understanding Tekton</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline.html#setup_your_pipeline">Set Up Your Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline.html#configure_manual_deployments_on_dev_application">Configure Manual Deployments on Dev Application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline.html#create_your_pipeline">Create Your Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline.html#run_the_pipeline">Run the Pipeline</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-java-pipeline-codechanges-github.html">Automation with Pipelines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline-codechanges-github.html#webhooks">Web Hooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline-codechanges-github.html#adding_triggers_to_your_pipeline">Adding Triggers to your Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline-codechanges-github.html#configuring_github_webhooks">Exercise: Configuring GitHub Web Hooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline-codechanges-github.html#using_github_webhooks">Exercise: Using GitHub Web Hooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline-codechanges-github.html#rollback">Exercise: Rollback</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline-codechanges-github.html#rollforward">Exercise: Rollforward</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="mlbparks-templates.html">MLBParks App</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-templates.html#templates">Templates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-templates.html#instantiate_template">Exercise: Instantiate a Template</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="mlbparks-binary-build.html">Binary Builds</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-binary-build.html#moving_on_from_s2i">Moving on From S2I</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-binary-build.html#fast_iterative_code_change_using_binary_deploy">Fast Iterative Code Change Using Binary Deploy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="mlbparks-binary-build.html#using_binary_deployment">Exercise: Using Binary Deployment</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mlbparks-binary-build.html#clone_source">Clone source</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mlbparks-binary-build.html#setup_the_build_of_the_war_file">Setup the Build of the WAR file</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mlbparks-binary-build.html#clone_change">Clone change</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mlbparks-binary-build.html#doing_the_binary_build">Doing the Binary Build</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="mlbparks-debugging.html">Debugging Apps</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-debugging.html#port_forwading_and_debugging">Background: Port Forwarding and Debugging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-debugging.html#enabling_debugging_in_eap_on_openshift">Exercise: Enabling Debugging in EAP on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="mlbparks-debugging.html#port-forwarding_from_pod_to_our_local_machine">Exercise: Port-Forwarding from the pod to our local machine</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mlbparks-debugging.html#setting_up_remote_debug_in_intellij">Setting up Remote Debug in IntelliJ</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="common-further-resources.html">Further Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-workshop-links.html">Workshop Links</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-workshop-links.html#openshift_cluster_url">OpenShift Cluster URL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-workshop-links.html#workshop_guides">Workshop Guides</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-workshop-links.html#web_terminal">Web terminal</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-workshop-links.html#git_server">Git Server</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">OpenShift Starter Guides</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">OpenShift Starter Guides</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-scholars/openshift-starter-guides/edit/roks/documentation/modules/ROOT/pages/nationalparks-javascript.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<div class="paragraph">
<p>In this lab, we&#8217;re going to deploy a backend service, developed in JavaScript
 that will expose 2 main REST endpoints to the visualizer
application (<code>parksmap</code> web component that was deployed in the previous labs).
The application will query for national parks information (including it&#8217;s
coordinates) that is stored in a MongoDB database.  This application will also
provide an external access point, so that the API provided can be directly used
by the end user.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/roadshow-app-architecture-nationalparks-1.png" alt="Application architecture" width="800">
</div>
</div>
<div class="sect1">
<h2 id="_background_source_to_image_s2i"><a class="anchor" href="#_background_source_to_image_s2i"></a>Background: Source-to-Image (S2I)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a previous lab, we learned how to deploy a pre-existing container
image. Now we will expand on that by learning how OpenShift builds
container images using source code from an existing repository.  This is accomplished using the Source-to-Image project.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/openshift/source-to-image">Source-to-Image (S2I)</a> is a
open source project sponsored by Red Hat that has the following goal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Source-to-image (S2I) is a tool for building reproducible container images. S2I
produces ready-to-run images by injecting source code into a container image and
assembling a new image which incorporates the builder image and built
source. The result is then ready to use with docker run. S2I supports
incremental builds which re-use previously downloaded dependencies, previously
built artifacts, etc.</code></pre>
</div>
</div>
<div class="paragraph">
<p>OpenShift is S2I-enabled and can use S2I as one of its build mechanisms (in
addition to building container images from Dockerfiles, and "custom" builds).</p>
</div>
<div class="paragraph">
<p>OpenShift runs the S2I process inside a special <strong>Pod</strong>, called a Build
Pod, and thus builds are subject to quotas, limits, resource scheduling, and
other aspects of OpenShift.</p>
</div>
<div class="paragraph">
<p>A full discussion of S2I is beyond the scope of this class, but you can find
more information about it either in the
<a href="https://docs.openshift.com/container-platform/4.5/creating_images/s2i.html">OpenShift S2I documentation</a>
or on <a href="https://github.com/openshift/source-to-image">GitHub</a>. The only key concept you need to
remember about S2I is that it&#8217;s magic.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exercise_creating_a_javascript_application"><a class="anchor" href="#_exercise_creating_a_javascript_application"></a>Exercise: Creating a JavaScript application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The backend service that we will be deploying as part of this exercise is
called <code>nationalparks</code>.  This is a JavaScript application that performs 2D
geo-spatial queries against a MongoDB database to locate and return map
coordinates of all National Parks in the world. That was just a fancy way of
saying that we are going to deploy a webservice that returns a JSON list of
places.</p>
</div>
<div class="sect2">
<h3 id="_add_to_project"><a class="anchor" href="#_add_to_project"></a>Add to Project</h3>
<div class="paragraph">
<p>Because the <code>nationalparks</code> component is a backend to serve data that our
existing frontend (parksmap) will consume, we are going to build it inside the existing
project that we have been working with. To illustrate how you can interact with OpenShift via the CLI or the Web Console, we will deploy the nationalparks component using the web console.</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_application_code_on_embedded_git_server"><a class="anchor" href="#_using_application_code_on_embedded_git_server"></a>Using application code on embedded Git server</h3>
<div class="paragraph">
<p>OpenShift can work with any accessible Git repository. This could be GitHub,
GitLab, or any other server that speaks Git. You can even register webhooks in
your Git server to initiate OpenShift builds triggered by any update to the
application code!</p>
</div>
<div class="paragraph">
<p>The repository that we are going to use is already cloned in the internal Gogs repository
and located at the following URL:</p>
</div>
<div class="paragraph">
<p><a href="http://gogs-%INFRA_PROJECT%.%CLUSTER_SUBDOMAIN%/%USERNAME%/nationalparks-js.git">Gogs Repository</a></p>
</div>
<div class="paragraph">
<p>Your Gogs credentials are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">username: %USERNAME%
password: %GOGS_PASSWORD%</code></pre>
</div>
</div>
<div class="paragraph">
<p>Later in the lab, we want you to make a code change and then rebuild your
application. This is a fairly simple JavaScript application.</p>
</div>
</div>
<div class="sect2">
<h3 id="_build_the_code_on_openshift"><a class="anchor" href="#_build_the_code_on_openshift"></a>Build the Code on OpenShift</h3>
<div class="paragraph">
<p>Similar to how we used <strong>+Add</strong> before with an existing image, we
can do the same for specifying a source code repository. Since for this lab you
have your own git repository, let&#8217;s use it with a simple JavaScript S2I image.</p>
</div>
<div class="paragraph">
<p>In the Developer Perspective, click <strong>+Add</strong> in the left navigation and then choose "From Git"</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/nationalparks-show-add-options.png" alt="Add to Project">
</div>
</div>
<div class="paragraph">
<p>The <strong>Import from Git</strong> workflow will guide you through the process of deploying your app based on a few selections.</p>
</div>
<div class="paragraph">
<p>Enter the following for Git Repo URL:</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>http://gogs-%INFRA_PROJECT%.%CLUSTER_SUBDOMAIN%/%USERNAME%/nationalparks.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Select Node.js as your Builder Image.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/nationalparks-import-from-git-url-builder.png" alt="Import from Git">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All of these builder images shown are made available via <strong>Templates</strong> and
<strong>ImageStreams</strong>, which will be discussed in a later lab.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Scroll down to the <strong>General</strong> section. Select <code>workshop</code> as your application, and <code>nationalparks</code> as the name.</p>
</div>
<div class="paragraph">
<p>Expand the Labels section and add 3 labels:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><em>app</em>=workshop</strong>  (the name we will be giving to the app)</p>
</li>
<li>
<p><strong><em>component</em>=nationalparks</strong>  (the name of this deployment)</p>
</li>
<li>
<p><strong><em>role</em>=backend</strong> (the role this component plays in the overall application)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now click the <strong>Create</strong> button.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/nationalparks-configure-service.png" alt="Runtimes">
</div>
</div>
<div class="paragraph">
<p>To see the build logs, in Topology view, click the <code>nationalparks</code> entry, then click on <strong>View Logs</strong> in the <strong>Builds</strong> section of the <strong>Resources</strong> tab.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/nationalparks-javascript-new-nodejs-build.png" alt="Nationalparks build">
</div>
</div>
<div class="paragraph">
<p>The initial build will take a few minutes to download all of the dependencies needed for
the application. You can see all of this happening in real time!</p>
</div>
<div class="paragraph">
<p>From the command line, you can also see the <strong>Builds</strong>:</p>
</div>
<div class="listingblock execute-1">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get builds</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll see output like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME              TYPE      FROM          STATUS     STARTED              DURATION
nationalparks-1   Source    Git@b052ae6   Running    About a minute ago   1m2s</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also view the build logs with the following command:</p>
</div>
<div class="listingblock execute-1">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc logs -f builds/nationalparks-1</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the build has completed and successfully:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The S2I process will push the resulting container image to the internal OpenShift registry</p>
</li>
<li>
<p>The <strong>DeploymentConfiguration</strong> (DC) will detect that the image has changed, and this
will cause a new deployment to happen.</p>
</li>
<li>
<p>A <strong>ReplicationController</strong> (RC) will be spawned for this new deployment.</p>
</li>
<li>
<p>The RC will detect no <strong>Pods</strong> are running and will cause one to be deployed, as our default replica count is just 1.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the end, when issuing the <code>oc get pods</code> command, you will see that the build Pod
has finished (exited) and that an application <strong>Pod</strong> is in a ready and running state:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                    READY     STATUS      RESTARTS   AGE
nationalparks-1-tkid3   1/1       Running     3          2m
nationalparks-1-build   0/1       Completed   0          3m
parksmap-1-4hbtk        1/1       Running     0          2h</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you look again at the web console, you will notice that, when you create the
application this way, OpenShift also creates a <strong>Route</strong> for you. You can see the
URL in the web console, or via the command line:</p>
</div>
<div class="listingblock execute-1">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get routes</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where you should see something like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME            HOST/PORT                                                   PATH      SERVICES        PORT       TERMINATION
nationalparks   nationalparks-workshop.%CLUSTER_SUBDOMAIN%             nationalparks   8080-tcp
parksmap        parksmap-workshop.%CLUSTER_SUBDOMAIN%                  parksmap        8080-tcp</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the URL is:</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&lt;a href="http://nationalparks-workshop.%CLUSTER_SUBDOMAIN%" class="bare"&gt;http://nationalparks-workshop.%CLUSTER_SUBDOMAIN%&lt;/a&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since this is a back-end application, it doesn&#8217;t actually have a web interface.
However, it can still be used with a browser. All backends that work with the parksmap
frontend are required to implement a <code>/ws/info/</code> endpoint. To test, visit this URL in your browser:</p>
</div>
<div class="paragraph">
<p><a href="http://nationalparks-workshop.%CLUSTER_SUBDOMAIN%/ws/info/">National Parks Info Page</a></p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The trailing slash is <strong>required</strong>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You will see a simple JSON string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{"id":"nationalparks-js","displayName":"National Parks (JS)","center":{"latitude":"47.039304","longitude":"14.505178"},"zoom":4}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Earlier we said:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">This is a JavaScript application that performs 2D geo-spatial queries
against a MongoDB database</code></pre>
</div>
</div>
<div class="paragraph">
<p>But we don&#8217;t have a database. Yet.</p>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
